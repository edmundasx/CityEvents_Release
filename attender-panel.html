<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mano Paskyra - CityEvents</title>
    

    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/attender-panel.css">
    <link rel="stylesheet" href="assets/css/navbar.css">
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <a href="index.html" class="logo">CityEvents</a>
                <nav class="nav">
                    <a href="index.html#events" class="nav-link" title="Renginiai â€“ pagrindinÄ— renginiÅ³ perÅ¾iÅ«ra">Renginiai</a>
                    <a href="city-map.html" class="nav-link" title="Å½emÄ—lapis â€“ vizualus renginiÅ³ Å¾emÄ—lapis">Å½emÄ—lapis</a>
                    <a href="for-organizers.html" class="nav-link" title="Organizatoriams â€“ informacija renginiÅ³ organizatoriams">Organizatoriams</a>
                    <a href="help-center.html" class="nav-link" title="Pagalba â€“ DUK ir pagalbos centras">Pagalba</a>
                </nav>
            </div>
            <div class="header-right">
                <div class="header-actions" id="authActions"></div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="page-header">
            <div class="page-header-text">
                <h1>Sveiki, <span id="userName">Vartotojas</span>! ğŸ‘‹</h1>
                <p>Valdykite savo pamÄ—gtus renginius ir perÅ¾iÅ«rÄ—kite rekomendacijas</p>
            </div>
            <button class="btn btn-accent" onclick="openProfileModal()">âœï¸ Redaguoti mano profilÄ¯</button>
        </div>

        <div class="dashboard-grid">
            <!-- Left Column -->
            <div class="left-column">
                <!-- Favorites Section -->
                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">â¤ï¸ PamÄ—gti renginiai</h2>
                        <span class="section-badge" id="favoritesCount">0 renginiai</span>
                    </div>
                    <div class="event-list" id="favoritesList">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Recommendations Section -->
                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">â­ Rekomenduojami renginiai</h2>
                        <a href="/" class="btn btn-outline" style="padding: 0.35rem 1rem; font-size: 0.85rem;">Å½iÅ«rÄ—ti visus</a>
                    </div>
                    <div class="recommendation-grid" id="recommendationsList">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div class="right-column">
                <!-- Calendar Section -->
                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“… RenginiÅ³ kalendorius</h2>
                    </div>
                    <div class="calendar-header-nav">
                        <button class="calendar-nav-btn" onclick="prevMonth()">â—€</button>
                        <span class="calendar-month" id="calendarMonth">Gruodis 2024</span>
                        <button class="calendar-nav-btn" onclick="nextMonth()">â–¶</button>
                    </div>
                    <div class="calendar-grid" id="calendarDayHeaders">
                        <div class="calendar-day-header">Pr</div>
                        <div class="calendar-day-header">An</div>
                        <div class="calendar-day-header">Tr</div>
                        <div class="calendar-day-header">Kt</div>
                        <div class="calendar-day-header">Pn</div>
                        <div class="calendar-day-header">Å t</div>
                        <div class="calendar-day-header">Sk</div>
                    </div>
                    <div class="calendar-grid" id="calendarDays">
                        <!-- Populated by JS -->
                    </div>
                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid hsl(var(--border));">
                        <p style="font-size: 0.85rem; color: hsl(var(--muted-foreground)); margin-bottom: 0.5rem;">Artimiausi renginiai:</p>
                        <div id="upcomingEventsList" style="font-size: 0.9rem;">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Edit Modal -->
    <div class="modal-overlay" id="profileModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Redaguoti profilÄ¯</h2>
                <button class="modal-close" onclick="closeProfileModal()">âœ•</button>
            </div>
            <form id="profileForm" onsubmit="saveProfile(event)">
                <div class="modal-body">
                    <div class="avatar-section">
                        <div class="avatar" id="modalAvatar">VU</div>
                        <div class="avatar-info">
                            <h3 id="modalUserName">Vartotojas</h3>
                            <p id="modalUserType">Lankytojas</p>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ğŸ‘¤ Vardas ir PavardÄ—</label>
                        <input type="text" class="form-input" id="inputName" placeholder="Ä®veskite vardÄ…" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ğŸ“§ El. paÅ¡tas</label>
                        <input type="email" class="form-input" id="inputEmail" placeholder="Ä®veskite el. paÅ¡tÄ…" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ğŸ“± Telefonas</label>
                        <input type="tel" class="form-input" id="inputPhone" placeholder="+370 600 00000">
                    </div>

                    <div class="form-group">
                        <label class="form-label">ğŸ“ Miestas</label>
                        <input type="text" class="form-input" id="inputCity" placeholder="Vilnius">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline" onclick="closeProfileModal()">AtÅ¡aukti</button>
                    <button type="submit" class="btn btn-primary">ğŸ’¾ IÅ¡saugoti</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Success Toast -->
    <div class="toast" id="successToast">
        âœ… Profilis sÄ—kmingai atnaujintas!
    </div>

    <script src="assets/js/api.js"></script>
    <script src="assets/js/app.js"></script>
    <script>
        // Mock data
        const favoriteEvents = [
            {
                id: 1,
                title: "Vasaros muzikos festivalis 2024",
                category: "Muzika",
                image: "https://images.unsplash.com/photo-1459749411175-04bf5292ceea?w=400",
                date: "2024-12-15",
                displayDate: "GruodÅ¾io 15, 18:00",
                location: "Vilnius, Vingio parkas",
                notifications: true
            },
            {
                id: 2,
                title: "TechnologijÅ³ konferencija TechVilnius",
                category: "Technologijos",
                image: "https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=400",
                date: "2024-12-20",
                displayDate: "GruodÅ¾io 20, 09:00",
                location: "Kaunas, Forum Palace",
                notifications: true
            },
            {
                id: 3,
                title: "KalÄ—dinÄ— mugÄ— senamiestyje",
                category: "Pramogos",
                image: "https://images.unsplash.com/photo-1482223250324-e0c08a3e0f1f?w=400",
                date: "2024-12-24",
                displayDate: "GruodÅ¾io 24, 10:00",
                location: "Vilnius, RotuÅ¡Ä—s aikÅ¡tÄ—",
                notifications: false
            }
        ];

        const recommendedEvents = [
            {
                id: 4,
                title: "Jazz vakaras â€Blue Noteâ€œ",
                category: "Muzika",
                image: "https://images.unsplash.com/photo-1511192336575-5a79af67a629?w=400",
                date: "GruodÅ¾io 18",
                location: "Vilnius",
                tag: "Populiarus"
            },
            {
                id: 5,
                title: "StartuoliÅ³ pitch konkursas",
                category: "Verslas",
                image: "https://images.unsplash.com/photo-1556761175-5973dc0f32e7?w=400",
                date: "GruodÅ¾io 22",
                location: "Kaunas",
                tag: "Naujas"
            },
            {
                id: 6,
                title: "NaujÅ³jÅ³ metÅ³ sutiktuvÄ—s",
                category: "Pramogos",
                image: "https://images.unsplash.com/photo-1467810563316-b5476525c0f9?w=400",
                date: "GruodÅ¾io 31",
                location: "Vilnius",
                tag: "Rekomenduojama"
            }
        ];

        const eventDates = [7, 15, 18, 20, 22, 24, 31];
        let currentMonth = 11; // December (0-indexed)
        let currentYear = 2024;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadUserData();
            renderFavorites();
            renderRecommendations();
            renderCalendar();
            renderUpcomingEvents();
        });

        function loadUserData() {
            const user = localStorage.getItem('currentUser');
            if (user) {
                const userData = JSON.parse(user);
                document.getElementById('userName').textContent = userData.name?.split(' ')[0] || 'Vartotojas';
            }
        }

        function renderFavorites() {
            const container = document.getElementById('favoritesList');
            document.getElementById('favoritesCount').textContent = `${favoriteEvents.length} renginiai`;

            if (favoriteEvents.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ’”</div>
                        <h3>NÄ—ra pamÄ—gtÅ³ renginiÅ³</h3>
                        <p>PradÄ—kite narÅ¡yti ir paÅ¾ymÄ—kite patinkanÄius renginius!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = favoriteEvents.map(event => `
                <div class="event-card" onclick="viewEvent(${event.id})">
                    <img src="${event.image}" alt="${event.title}" class="event-card-image">
                    <div class="event-card-content">
                        <span class="event-card-category">${event.category}</span>
                        <h3 class="event-card-title">${event.title}</h3>
                        <div class="event-card-info">
                            <span>ğŸ“… ${event.displayDate}</span>
                            <span>ğŸ“ ${event.location}</span>
                        </div>
                    </div>
                    <div class="event-card-actions">
                        <button class="btn-icon ${event.notifications ? 'active' : ''}" onclick="toggleNotification(event, ${event.id})" title="${event.notifications ? 'PraneÅ¡imai Ä¯jungti' : 'Ä®jungti praneÅ¡imus'}">
                            ${event.notifications ? 'ğŸ””' : 'ğŸ”•'}
                        </button>
                        <button class="btn-icon" onclick="removeFavorite(event, ${event.id})" title="PaÅ¡alinti iÅ¡ pamÄ—gtÅ³">
                            â¤ï¸
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function renderRecommendations() {
            const container = document.getElementById('recommendationsList');
            
            container.innerHTML = recommendedEvents.map(event => `
                <div class="recommendation-card" onclick="viewEvent(${event.id})">
                    <img src="${event.image}" alt="${event.title}" class="recommendation-image">
                    <div class="recommendation-body">
                        <span class="recommendation-tag">${event.tag}</span>
                        <h3 class="recommendation-title">${event.title}</h3>
                        <div class="recommendation-info">
                            <span>ğŸ“… ${event.date}</span> â€¢ <span>ğŸ“ ${event.location}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderCalendar() {
            const container = document.getElementById('calendarDays');
            const monthNames = ['Sausis', 'Vasaris', 'Kovas', 'Balandis', 'GeguÅ¾Ä—', 'BirÅ¾elis', 
                               'Liepa', 'RugpjÅ«tis', 'RugsÄ—jis', 'Spalis', 'Lapkritis', 'Gruodis'];
            
            document.getElementById('calendarMonth').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const adjustedFirstDay = firstDay === 0 ? 6 : firstDay - 1;
            
            const today = new Date();
            const isCurrentMonth = today.getMonth() === currentMonth && today.getFullYear() === currentYear;
            
            let html = '';
            
            // Previous month days
            const prevMonthDays = new Date(currentYear, currentMonth, 0).getDate();
            for (let i = adjustedFirstDay - 1; i >= 0; i--) {
                html += `<div class="calendar-day other-month">${prevMonthDays - i}</div>`;
            }
            
            // Current month days
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = isCurrentMonth && day === today.getDate();
                const hasEvent = eventDates.includes(day);
                let classes = 'calendar-day';
                if (isToday) classes += ' today';
                if (hasEvent) classes += ' has-event';
                html += `<div class="${classes}" onclick="selectDay(${day})">${day}</div>`;
            }
            
            // Next month days
            const totalCells = adjustedFirstDay + daysInMonth;
            const remaining = 42 - totalCells;
            for (let i = 1; i <= remaining && totalCells + i <= 42; i++) {
                html += `<div class="calendar-day other-month">${i}</div>`;
            }
            
            container.innerHTML = html;
        }

        function renderUpcomingEvents() {
            const container = document.getElementById('upcomingEventsList');
            const upcoming = favoriteEvents.slice(0, 3);
            
            if (upcoming.length === 0) {
                container.innerHTML = '<p style="color: hsl(var(--muted-foreground));">NÄ—ra artimÅ³ renginiÅ³</p>';
                return;
            }
            
            container.innerHTML = upcoming.map(event => `
                <div style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 0; border-bottom: 1px solid hsl(var(--border) / 0.5);">
                    <span style="color: hsl(var(--accent));">â€¢</span>
                    <span style="flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${event.title}</span>
                    <span style="color: hsl(var(--muted-foreground)); font-size: 0.8rem;">${event.date.split('-')[2]}d.</span>
                </div>
            `).join('');
        }

        function prevMonth() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
        }

        function nextMonth() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar();
        }

        function selectDay(day) {
            console.log('Selected day:', day);
        }

        function toggleNotification(e, eventId) {
            e.stopPropagation();
            const event = favoriteEvents.find(ev => ev.id === eventId);
            if (event) {
                event.notifications = !event.notifications;
                renderFavorites();
            }
        }

        function removeFavorite(e, eventId) {
            e.stopPropagation();
            const index = favoriteEvents.findIndex(ev => ev.id === eventId);
            if (index > -1) {
                favoriteEvents.splice(index, 1);
                renderFavorites();
            }
        }

        function viewEvent(eventId) {
            window.location.href = `/event-details.html?id=${eventId}`;
        }

        // Profile Modal
        function openProfileModal() {
            const modal = document.getElementById('profileModal');
            modal.classList.add('active');
            
            const user = localStorage.getItem('currentUser');
            if (user) {
                const userData = JSON.parse(user);
                document.getElementById('inputName').value = userData.name || '';
                document.getElementById('inputEmail').value = userData.email || '';
                document.getElementById('inputPhone').value = userData.phone || '';
                document.getElementById('inputCity').value = userData.city || userData.location || '';
                
                const initials = (userData.name || 'VU').split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
                document.getElementById('modalAvatar').textContent = initials;
                document.getElementById('modalUserName').textContent = userData.name || 'Vartotojas';
                document.getElementById('modalUserType').textContent = userData.type === 'organizer' ? 'Organizatorius' : 'Lankytojas';
            }
        }

        function closeProfileModal() {
            document.getElementById('profileModal').classList.remove('active');
        }

        function saveProfile(e) {
            e.preventDefault();
            
            const userData = {
                name: document.getElementById('inputName').value,
                email: document.getElementById('inputEmail').value,
                phone: document.getElementById('inputPhone').value,
                city: document.getElementById('inputCity').value,
                type: 'visitor'
            };
            
            localStorage.setItem('currentUser', JSON.stringify(userData));
            closeProfileModal();
            loadUserData();
            
            const toast = document.getElementById('successToast');
            toast.classList.add('active');
            setTimeout(() => toast.classList.remove('active'), 3000);
        }

        // Close modal on overlay click
        document.getElementById('profileModal').addEventListener('click', (e) => {
            if (e.target.id === 'profileModal') {
                closeProfileModal();
            }
        });

        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = '/';
        }
    </script>
</body>
</html>
